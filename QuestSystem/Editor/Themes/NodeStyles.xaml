<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:nodes="clr-namespace:QuestEditor.Nodes"
                    xmlns:objectives="clr-namespace:QuestEditor.Objectives">

    <Style x:Key="NodeControlBaseStyle" TargetType="nodes:NodeControl">
        <Setter Property="Canvas.Left" Value="{Binding CanvasLeft, Mode=TwoWay}"/>
        <Setter Property="Canvas.Top" Value="{Binding CanvasTop, Mode=TwoWay}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="nodes:NodeControl">
                    <Border 
                            Background="{TemplateBinding Background}" 
                            BorderBrush="{TemplateBinding BorderBrush}" 
                            BorderThickness="{TemplateBinding BorderThickness}" 
                            CornerRadius="{DynamicResource NodeCornerRadius}"
                            Opacity="{TemplateBinding Opacity}">
                        <StackPanel Background="DarkOrange">
                            <TextBlock Text="{Binding}" Foreground="Yellow"/>
                            <TextBlock Text="{Binding ID}" Background="Green"/>
                            <ContentPresenter 
                                Content="{Binding DataContext, RelativeSource={RelativeSource TemplatedParent}}"
                                ContentTemplate="{TemplateBinding ContentTemplate}"/>
                            <StackPanel Orientation="Horizontal">
                                <CheckBox Content="Rollback" IsChecked="{Binding Rollback}"/>
                                <TextBox Text="{Binding NextIDString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <Style x:Key="NodeControlDefaultStyle" TargetType="nodes:NodeControl" BasedOn="{StaticResource NodeControlBaseStyle}">
        <Setter Property="Opacity" Value="0.8"/>
    </Style>

    <Style x:Key="StageNodeControlStyle" TargetType="nodes:StageNodeControl" BasedOn="{StaticResource NodeControlBaseStyle}">
        <Style.Resources>
            <DataTemplate DataType="{x:Type objectives:ObjectiveVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
            <DataTemplate DataType="{x:Type objectives:ObjectiveInteractVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
            <DataTemplate DataType="{x:Type objectives:ObjectiveKillVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
            <DataTemplate DataType="{x:Type objectives:ObjectiveDeliverVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
            <DataTemplate DataType="{x:Type objectives:ObjectiveObtainVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
            <DataTemplate DataType="{x:Type objectives:ObjectiveExploreVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
            <DataTemplate DataType="{x:Type objectives:ObjectiveSpellcastVM}">
                <objectives:ObjectiveControl Style="{StaticResource ObjectiveControlDefaultStyle}"/>
            </DataTemplate>
        </Style.Resources>
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <StackPanel Width="150" MaxHeight="360">
                        <TextBlock Text="{Binding JournalEntry}"/>
                        <ListBox ItemsSource="{Binding Objectives}"/>
                    </StackPanel>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ContextMenu">
            <Setter.Value>
                <ContextMenu>
                    <MenuItem Header="Add objective">
                        <MenuItem Header="Interact" Command="{Binding AddObjectiveInteract}"/>
                        <MenuItem Header="Kill" Command="{Binding AddObjectiveKill}"/>
                        <MenuItem Header="Deliver" Command="{Binding AddObjectiveDeliver}"/>
                        <MenuItem Header="Obtain" Command="{Binding AddObjectiveObtain}"/>
                        <MenuItem Header="Explore" Command="{Binding AddObjectiveExplore}"/>
                        <MenuItem Header="Spellcast" Command="{Binding AddObjectiveSpellcast}"/>
                    </MenuItem>
                    <Separator/>
                    <MenuItem Header="Delete node" Command="{Binding DeleteNodeCommand}" CommandParameter="{Binding}"/>
                </ContextMenu>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="RewardNodeControlStyle" TargetType="nodes:RewardNodeControl" BasedOn="{StaticResource NodeControlBaseStyle}">
        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <StackPanel>
                        <TextBlock Text="RewardNodeControlStyle" Background="Green"/>
                    </StackPanel>
                </DataTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ContextMenu">
            <Setter.Value>
                <ContextMenu>
                    <MenuItem Header="Delete node" Command="{Binding DeleteNodeCommand}" CommandParameter="{Binding}"/>
                </ContextMenu>
            </Setter.Value>
        </Setter>
    </Style>


    
    
</ResourceDictionary>